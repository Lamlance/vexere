generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model testtable {
  id      Int  @id @default(autoincrement())
  randNum Int?
}

model User {
  id      Int     @id @default(autoincrement())
  Name    String
  phone   String? @db.VarChar(15)
  isAdmin Boolean @default(false)
  email   String?
  uuid    String
}

model Location {
  id         Int     @id @default(autoincrement())
  name       String
  EndRoute   Route[] @relation("ending")
  StartRoute Route[] @relation("starting")
}

model Route {
  id          Int           @id @default(autoincrement())
  startLocId  Int
  endLocId    Int
  endtLoc     Location      @relation("ending", fields: [endLocId], references: [id])
  startLoc    Location      @relation("starting", fields: [startLocId], references: [id])
  RouteDetail RouteDetail[]
}

model RouteDetail {
  id         Int      @id @default(autoincrement())
  busId      Int
  price      Decimal  @db.Money
  endTime    DateTime
  startTime  DateTime
  remainSeat Int
  routeId    Int
  bus        Bus      @relation("busRoute", fields: [busId], references: [id])
  route      Route    @relation(fields: [routeId], references: [id])
  ticket     Ticket[] @relation("routeDetail")
}

model BusHouse {
  id    Int    @id @default(autoincrement())
  Name  String @db.Char(50)
  buses Bus[]
}

model Bus {
  id         Int           @id @default(autoincrement())
  plate      String        @db.Char(20)
  seatAmount Int
  type       Int
  busHouse   Int
  house      BusHouse      @relation(fields: [busHouse], references: [id])
  busroute   RouteDetail[] @relation("busRoute")
}

model Ticket {
  id            Int         @id @default(autoincrement())
  rating        Int
  comment       String?
  routeDetailId Int
  rate          Rating?     @relation("ticketRating")
  routeDetail   RouteDetail @relation("routeDetail", fields: [routeDetailId], references: [id])
}

model Rating {
  id       Int     @id @default(autoincrement())
  rating   Int
  comment  String?
  ticketId Int     @unique
  ticket   Ticket  @relation("ticketRating", fields: [ticketId], references: [id])
}
